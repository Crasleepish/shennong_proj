import pytest
import datetime
from app import create_app
from app.database import Base, engine
from sqlalchemy import create_engine, text
from sqlalchemy.orm import sessionmaker
from app.data.fetcher import StockInfoSynchronizer, StockHistSynchronizer, CompanyActionSynchronizer, FundamentalDataSynchronizer, SuspendDataSynchronizer
from app.data.fetcher import stock_adj_hist_synchronizer
from app.data.cninfo_fetcher import cninfo_stock_share_change_fetcher
from types import SimpleNamespace
from app.database import get_db

# Use the TestConfig from our config module
from app.config import TestConfig, Config
from app.dao.stock_info_dao import StockInfoDao, StockHistUnadjDao, StockHistAdjDao, FundamentalDataDao, SuspendDataDao, StockShareChangeCNInfoDao, CompanyActionDao, FutureTaskDao
from app.data.helper import get_prices_df, get_fund_prices_by_code_list, get_fund_fees_by_code_list

# Create the Flask app using TestConfig
@pytest.fixture
def app():
    app = create_app(config_class=Config)
    # Note: since our app's init_db() was already called, we assume the tables are created.
    # If necessary, you could call init_db() again here.
    yield app

# Example test for the index route
def test_StockInfoSynchronizer(app):
    try:
        stock_info_synchronizer = StockInfoSynchronizer()
        stock_info_synchronizer.sync()
    finally:
        stock_info_dao = StockInfoDao._instance
        stock_info_dao.delete_all()

@pytest.fixture
def dummy_stock_list():
    """
    返回仅包含三个股票的列表：
      - 000004
      - 600601
      - 000001
    使用 SimpleNamespace 模拟股票对象，要求至少有 stock_code 属性。
    """
    return [
        SimpleNamespace(stock_code="000004", market="SZ"),
        SimpleNamespace(stock_code="600655", market="SH"),
        SimpleNamespace(stock_code="301600", market="SZ"),
    ]

@pytest.fixture
def init_update_flag_data(app):
    """
    测试开始前自动执行，将 update_flag 表中插入 mock 数据
    """
    # 获取数据库会话
    with get_db() as db:
        try:
            # 执行插入 SQL
            sql = """
            INSERT INTO update_flag (stock_code, action_update_flag, fundamental_update_flag)
            VALUES ('000004', '0', '1'), ('600655', '0', '1'), ('301600', '0', '1');
            """
            db.execute(text(sql))
            db.commit()
        except Exception as e:
            print(f"Error executing SQL: {e}")


def test_StockHistSynchronizer(app, monkeypatch, dummy_stock_list):
    # 1. 替换 StockInfoDao.load_stock_info，使其返回 dummy_stock_list
    def fake_load_stock_info(self):
        return dummy_stock_list

    monkeypatch.setattr(StockInfoDao, "load_stock_info", fake_load_stock_info)

    # 2. 创建同步器实例并调用 sync 方法
    synchronizer = StockHistSynchronizer()
    synchronizer.sync()

    stock_hist_unadj_dao = StockHistUnadjDao._instance
    df0 = stock_hist_unadj_dao.select_dataframe_by_code("600655")
    print(df0)

    stock_hist_unadj_dao.delete_all()

def test_CompanyActionSynchronizer(app, init_update_flag_data, monkeypatch, dummy_stock_list):
    def fake_load_stock_info(self):
        return dummy_stock_list
    
    try:
        monkeypatch.setattr(StockInfoDao, "load_stock_info", fake_load_stock_info)

        stock_hist_synchronizer = StockHistSynchronizer()
        stock_hist_synchronizer.sync()
        synchronizer = CompanyActionSynchronizer()
        synchronizer.sync()
    finally:
        company_action_dao = CompanyActionDao._instance
        company_action_dao.delete_all()
        stock_hist_unadj_dao = StockHistUnadjDao._instance
        stock_hist_unadj_dao.delete_all()

def test_AdjSynchronizer(app, init_update_flag_data, monkeypatch, dummy_stock_list):
    def fake_load_stock_info(self):
        return dummy_stock_list
    
    monkeypatch.setattr(StockInfoDao, "load_stock_info", fake_load_stock_info)
    try:
        stock_hist_synchronizer = StockHistSynchronizer()
        stock_hist_synchronizer.sync()
        synchronizer = CompanyActionSynchronizer()
        synchronizer.sync()
        stock_adj_hist_synchronizer.sync()

        stock_hist_unadj_dao = StockHistUnadjDao._instance
        df0 = stock_hist_unadj_dao.select_dataframe_by_code("600655")
        print(df0)

        stock_hist_adj_dao = StockHistAdjDao._instance
        df = stock_hist_adj_dao.select_dataframe_by_code("600655")
        print(df)

        stock_hist_synchronizer.sync()
        synchronizer.sync()
        stock_adj_hist_synchronizer.sync()

        df2 = stock_hist_adj_dao.select_dataframe_by_code("600655")
        print(df2)

        assert df2.equals(df)
    finally:
        stock_hist_unadj_dao = StockHistUnadjDao._instance
        stock_hist_adj_dao = StockHistAdjDao._instance
        company_action_dao = CompanyActionDao._instance
        future_task_dao = FutureTaskDao._instance
        stock_hist_unadj_dao.delete_all()
        stock_hist_adj_dao.delete_all()
        company_action_dao.delete_all()
        future_task_dao.delete_all()


def test_FundamentalDataSynchronizer(app, init_update_flag_data, monkeypatch, dummy_stock_list):
    def fake_load_stock_info(self):
        return dummy_stock_list
    
    monkeypatch.setattr(StockInfoDao, "load_stock_info", fake_load_stock_info)
    try:
        fundatmental_data_synchronizer = FundamentalDataSynchronizer()
        fundatmental_data_synchronizer.sync()
        fundatmental_data_synchronizer.sync()

        fundamental_data_dao = FundamentalDataDao._instance
        df = fundamental_data_dao.select_dataframe_by_code("600655")
        print(df)
    finally:
        fundamental_data_dao.delete_all()

def test_SuspendDataSynchronizer(app):
    suspend_data_synchronizer = SuspendDataSynchronizer()
    suspend_data_synchronizer.sync_all("20120222")
    suspend_data_synchronizer.sync_today()
    suspend_data_dao = SuspendDataDao._instance
    df1 = suspend_data_dao.select_dataframe_all()
    print(df1)
    df2 = suspend_data_dao.get_suspended_stocks_by_date(datetime.date(2024, 10, 22))
    print(df2)

def test_CninfoStockShareChangeFetcher(app, monkeypatch, dummy_stock_list):
    def fake_load_stock_info(self):
        return dummy_stock_list
    
    monkeypatch.setattr(StockInfoDao, "load_stock_info", fake_load_stock_info)

    cninfo_stock_share_change_fetcher.fetch_cninfo_data()
    stock_share_change_cninfo_dao = StockShareChangeCNInfoDao._instance
    df = stock_share_change_cninfo_dao.select_dataframe_all()
    print(df)
    stock_share_change_cninfo_dao.delete_all()
    
def test_helper(app):
    with get_db() as db:
        try:
            # 执行插入 SQL
            sql1 = """
            INSERT INTO stock_hist_adj (stock_code,"date","open","close",high,low,volume,amount,amplitude,change_percent,"change",turnover_rate,mkt_cap,total_shares) VALUES
	 ('000001','2025-02-28',11.58,11.53,11.68,11.5,94908800,1094298464,1.5490533562822695,-0.7745266781411347,-0.08999999999999986,0.49,223750236823,19405918198),
	 ('000001','2025-02-27',11.53,11.62,11.63,11.46,97731000,1135634220,1.475694444444444,0.8680555555555525,0.09999999999999964,0.5,225496769461,19405918198),
	 ('000001','2025-02-26',11.47,11.52,11.6,11.47,84164600,969576192,1.1333914559720926,0.43591979075849113,0.049999999999998934,0.43,223556177641,19405918198),
	 ('000001','2025-02-25',11.56,11.47,11.58,11.46,91715600,1051977932,1.035375323554782,-1.035375323554782,-0.11999999999999922,0.47,222585881731,19405918198),
	 ('000001','2025-02-24',11.63,11.59,11.69,11.56,94995600,1100999004,1.1168384879725,-0.42955326460481713,-0.05000000000000071,0.49,224914591915,19405918198),
	 ('000001','2025-02-21',11.69,11.64,11.71,11.55,97396900,1133699916,1.3722126929674112,-0.17152658662092257,-0.019999999999999574,0.5,225884887825,19405918198),
	 ('000001','2025-02-20',11.71,11.66,11.76,11.65,78439600,914605736,0.9393680614859046,-0.4269854824936013,-0.05000000000000071,0.4,226273006189,19405918198),
	 ('000001','2025-02-19',11.8,11.71,11.81,11.68,117774900,1379144079,1.1007620660457307,-0.8467400508044001,-0.09999999999999964,0.61,227243302099,19405918198);
            """
            db.execute(text(sql1))
            sql2 = """
            INSERT INTO public.stock_hist_adj (stock_code,"date","open","close",high,low,volume,amount,amplitude,change_percent,"change",turnover_rate,mkt_cap,total_shares) VALUES
	 ('600605','2025-02-28',35.63,35.15,35.81,35.05,2223000,78138450,2.133033960145959,-1.3471793432500812,-0.480000000000004,1.08,7250827379,206282429),
	 ('600605','2025-02-27',35.4,35.63,36.47,35.21,2841500,101242645,3.5522977163800338,0.45108542430223764,0.1600000000000037,1.38,7349842945,206282429),
	 ('600605','2025-02-26',35.89,35.47,36.24,34.89,3698900,131199983,3.7583518930957722,-1.252783964365264,-0.45000000000000284,1.79,7316837757,206282429),
	 ('600605','2025-02-25',36.5,35.92,36.5,35.66,2839200,101984064,2.3178807947019964,-0.8830022075055195,-0.3200000000000003,1.38,7409664850,206282429),
	 ('600605','2025-02-24',36.77,36.24,36.95,35.96,3520600,127586544,2.6756756756756808,-2.0540540540540486,-0.759999999999998,1.71,7475675227,206282429),
	 ('600605','2025-02-21',37.99,37.0,37.99,36.71,3053500,112979500,3.3737480231945205,-2.477596204533468,-0.9399999999999977,1.48,7632449873,206282429);
            """
            db.execute(text(sql2))
            sql3 = """
            INSERT INTO public.stock_hist_adj (stock_code,"date","open","close",high,low,volume,amount,amplitude,change_percent,"change",turnover_rate,mkt_cap,total_shares) VALUES
	 ('600519','2025-02-27',1460.02,1485.56,1489.9,1454.0,4976200,7392443672,2.458887267895432,1.7499880137807244,25.549999999999955,0.4,1866157203768,1256197800),
	 ('600519','2025-02-26',1455.45,1460.01,1464.96,1445.0,2636600,3849462366,1.3727647867950505,0.41334250343878887,6.009999999999991,0.21,1834061349978,1256197800),
	 ('600519','2025-02-25',1470.01,1454.0,1473.39,1452.0,2838700,4127469800,1.4461790178963878,-1.6949840102226357,-25.069999999999936,0.23,1826511601200,1256197800),
	 ('600519','2025-02-24',1488.0,1479.07,1499.52,1474.0,3474400,5138880808,1.714811753717552,-0.6141606359317636,-9.1400000000001,0.28,1858004480046,1256197800),
	 ('600519','2025-02-21',1480.0,1488.21,1496.73,1473.01,3641800,5419763178,1.609226594301223,0.9640434192673023,14.210000000000036,0.29,1869486127938,1256197800),
	 ('600519','2025-02-20',1483.0,1474.0,1491.97,1473.39,2375000,3500750000,1.2461435278336639,-1.1401743796109993,-17.0,0.19,1851635557200,1256197800),
	 ('600519','2025-02-19',1475.05,1491.0,1494.44,1464.9,3239300,4829796300,2.002711864406777,1.0847457627118644,16.0,0.26,1872990919800,1256197800),
	 ('600519','2025-02-18',1470.0,1475.0,1492.99,1462.08,2780000,4100500000,2.100406354901407,0.22967885731371615,3.380000000000109,0.22,1852891755000,1256197800),
	 ('600519','2025-02-17',1481.0,1471.62,1494.98,1467.1,3247100,4778497302,1.890169491525431,-0.22915254237288873,-3.380000000000109,0.26,1848645806436,1256197800),
	 ('600519','2025-02-14',1465.06,1475.0,1477.0,1458.22,2710000,3997250000,1.2818587634636105,0.6784705063273897,9.940000000000055,0.22,1852891755000,1256197800);
            """
            db.execute(text(sql3))
            db.commit()
            df = get_prices_df()
            print(df)
        except Exception as e:
            print(f"Error executing SQL: {e}")
        finally:
            db.rollback()
            stock_hist_adj_dao = StockHistAdjDao._instance
            stock_hist_adj_dao.delete_all()

def test_strategy(app):
    with get_db() as db:
        try:
            # 执行插入 SQL
            sql1 = """
            INSERT INTO public.stock_hist_adj (stock_code,"date","open","close",high,low,volume,amount,amplitude,change_percent,"change",turnover_rate,mkt_cap,total_shares) VALUES
	 ('000001','2010-05-04',5.652455974232582,5.624334302718987,5.708699317259772,5.559654458237719,101966556,573494000,2.577821011673157,-2.723735408560307,-0.15748136047613137,0.98,62108675240,3105433762),
	 ('000001','2010-05-05',5.6496438070812225,5.596212631205392,5.686201980048896,5.44435560503198,231288528,1294339780,4.299999999999992,-0.4999999999999935,-0.02812167151359457,2.22,61798131864,3105433762),
	 ('000001','2010-05-06',5.537157121026843,5.174387558501468,5.537157121026843,5.149078054139233,243867794,1261866479.9999998,6.9346733668341765,-7.537688442211069,-0.4218250727039248,2.35,57139981221,3105433762),
	 ('000001','2010-05-07',5.070337373901167,5.135017218382436,5.216570065771861,5.047840036690291,146712474,753371080.0000001,3.260869565217401,-0.7608695652173644,-0.03937034011903151,1.41,56705220494,3105433762),
	 ('000001','2010-05-10',5.160326722744672,5.182824059955546,5.253128238739534,5.115332048322919,137408973,712166530.9999999,2.6834611171960474,0.9309967141292234,0.047806841573110326,1.32,57233144234,3105433762),
	 ('000001','2010-05-11',5.303747247464005,4.912856013425035,5.312183748918084,4.910043846273676,199745239,981319598.9999999,7.7590884427563855,-5.208898534997288,-0.26996804653051143,1.92,54251927822,3105433762),
	 ('000001','2010-05-12',4.865049171851925,5.092834711112043,5.146265886987874,4.825678831732891,185280950,943605251,6.525472238122501,3.6634230108757935,0.17997869768700792,1.78,56239405430,3105433762),
	 ('000001','2010-05-13',5.064713039598448,5.253128238739534,5.320620250372163,5.061900872447088,201811261,1060140436,5.08006626173387,3.147432357813366,0.16029352762749127,1.94,58009502674,3105433762),
	 ('000001','2010-05-14',5.253128238739534,5.160326722744672,5.255940405890894,5.1181442154742784,94456690,487427380.00000006,2.6231263383297723,-1.7665952890792147,-0.09280151599486253,0.91,56984709533,3105433762),
	 ('000001','2010-05-17',5.061900872447088,4.901607344819597,5.067525206749807,4.876297840457362,116141034,569277744,3.7057220708446894,-5.013623978201655,-0.2587193779250745,1.12,54127710472,3105433762);
INSERT INTO public.stock_hist_adj (stock_code,"date","open","close",high,low,volume,amount,amplitude,change_percent,"change",turnover_rate,mkt_cap,total_shares) VALUES
	 ('000001','2010-05-18',4.921292514879114,5.05346437099301,5.092834711112043,4.865049171851925,128691141,650336096.9999999,4.647160068846801,3.0981067125645403,0.15185702617341246,1.24,55804644703,3105433762),
	 ('000001','2010-05-19',4.988784526511742,4.9944088608144614,5.1097077140202005,4.895983010516878,91159588,455288256.00000006,4.229271007234295,-1.1686143572620795,-0.059055510178548154,0.88,55152503613,3105433762),
	 ('000001','2010-05-20',4.94097768493863,4.9353533506359115,5.075961708203886,4.915668180576395,77623053,383097195,3.2094594594594614,-1.1824324324324436,-0.05905551017854993,0.75,54500362523,3105433762),
	 ('000001','2010-05-21',4.808805828824735,5.011281863722618,5.025342699479416,4.786308491613858,78514181,393456690.00000006,4.843304843304861,1.5384615384615452,0.07592851308670667,0.76,55338829639,3105433762),
	 ('000001','2010-05-24',5.039403535236213,5.1715753913501095,5.2306309015286585,5.039403535236213,113050179,584647524.0000001,3.815937149270486,3.1986531986532007,0.16029352762749127,1.09,57108926883,3105433762),
	 ('000001','2010-05-25',5.1181442154742784,5.002845362268539,5.132205051231076,4.9915966936631015,87457817,437537934.00000006,2.7188689505165837,-3.2626427406199108,-0.1687300290815701,0.84,55245666626,3105433762),
	 ('000001','2010-05-26',5.028154866630774,5.033779200933493,5.1097077140202005,5.008469696571258,61024466,307183689.99999994,2.0236087689713416,0.6183249016301123,0.030933838664953583,0.59,55587264340,3105433762),
	 ('000001','2010-05-27',5.025342699479416,5.081586042506605,5.095646878263403,4.910043846273676,98915528,502647769,3.687150837988832,0.9497206703910757,0.0478068415731121,0.95,56115188079,3105433762),
	 ('000001','2010-05-28',5.132205051231076,5.084398209657964,5.1715753913501095,5.067525206749807,90312555,459184992,2.0475926950747265,0.055340343110117825,0.002812167151359013,0.87,56146242417,3105433762),
	 ('000001','2010-05-31',5.033779200933493,4.924104682030474,5.1181442154742784,4.921292514879114,96174226,473571958,3.871681415929206,-3.1526548672566226,-0.16029352762749038,0.92,54376145173,3105433762);
INSERT INTO public.stock_hist_adj (stock_code,"date","open","close",high,low,volume,amount,amplitude,change_percent,"change",turnover_rate,mkt_cap,total_shares) VALUES
	 ('000001','2010-06-01',4.901607344819597,4.865049171851925,4.974723690754945,4.83411533318697,77552645,377297430.00000006,2.855511136493431,-1.199314677327235,-0.05905551017854904,0.75,53724004083,3105433762),
	 ('000001','2010-06-02',4.850988336095127,4.845364001792408,4.895983010516878,4.7581868201002635,89346040,432914088,2.832369942196522,-0.4046242774566512,-0.019685170059516643,0.86,53506623719,3105433762),
	 ('000001','2010-06-03',4.867861339003283,4.842551834641048,4.980348025057664,4.842551834641048,102256368,495181764,2.8438769587928117,-0.05803830528149418,-0.002812167151359901,0.98,53475569382,3105433762),
	 ('000001','2010-06-04',4.839739667489689,4.865049171851925,4.921292514879114,4.825678831732891,47911448,233091550,1.9744483159117234,0.46457607433218423,0.022497337210876545,0.46,53724004083,3105433762),
	 ('000001','2010-06-07',4.808805828824735,4.755374652948904,4.865049171851925,4.727252981435308,85874341,408364663,2.8323699421965585,-2.254335260115623,-0.10967451890302105,0.83,52512884915,3105433762),
	 ('000001','2010-06-08',4.7581868201002635,4.696319142770355,4.786308491613858,4.6400757997431645,60568946,284451100,3.0751034890597255,-1.2418687167356526,-0.05905551017854904,0.58,51860743825,3105433762),
	 ('000001','2010-06-09',4.721628647132589,4.969099356452226,5.002845362268539,4.66257313695404,176285396,875979648.0000001,7.245508982035938,5.808383233532943,0.27278021368187133,1.7,54873014575,3105433762),
	 ('000001','2010-06-10',4.856612670397846,4.811617995976094,4.912856013425035,4.803181494522015,101217668,487020751,2.2071307300509315,-3.1692133559705833,-0.15748136047613226,0.97,53133971668,3105433762),
	 ('000001','2010-06-11',4.839739667489689,4.8228666645815315,4.910043846273676,4.780684157311139,74669459,360120844.99999994,2.6884862653419073,0.23378141437755393,0.011248668605437828,0.72,53258189018,3105433762),
	 ('000001','2010-06-18',4.83411533318697,4.870673506154644,4.9915966936631015,4.8228666645815315,159483052,776789876,3.498542274052488,0.9912536443148835,0.0478068415731121,1.53,53786112758,3105433762);
INSERT INTO public.stock_hist_adj (stock_code,"date","open","close",high,low,volume,amount,amplitude,change_percent,"change",turnover_rate,mkt_cap,total_shares) VALUES
	 ('000001','2010-06-21',4.867861339003283,5.146265886987874,5.208133564317782,4.867861339003283,209733977,1079346810.0000002,6.986143187066983,5.658198614318706,0.27559238083323034,2.02,56829437845,3105433762),
	 ('000001','2010-06-22',5.132205051231076,5.210945731469142,5.2924985788585674,5.092834711112043,148333288,772956714,3.879781420765037,1.2568306010928882,0.06467984448126796,1.43,57543687610,3105433762),
	 ('000001','2010-06-23',5.146265886987874,5.160326722744672,5.236255235831377,5.098459045414762,115455441,595787800.0000001,2.6443604964921827,-0.971397733405276,-0.05061900872447023,1.11,56984709533,3105433762),
	 ('000001','2010-06-24',5.146265886987874,5.210945731469142,5.2896864117072075,5.126580716928357,83037383,432703295,3.160762942779284,0.9809264305176982,0.05061900872447023,0.8,57543687610,3105433762),
	 ('000001','2010-06-25',5.1715753913501095,5.092834711112043,5.202509230015063,5.070337373901167,80899530,412007932.99999994,2.5364274150026906,-2.2665947112790117,-0.11811102035709897,0.78,56239405430,3105433762),
	 ('000001','2010-06-28',5.075961708203886,5.199697062863703,5.2306309015286585,5.075961708203886,86818452,451429651.9999999,3.0369961347321963,2.098288238542232,0.10686235175166026,0.79,57419470259,3105433762),
	 ('000001','2010-06-29',5.210945731469142,4.924104682030474,5.210945731469142,4.921292514879114,109055751,537001933,5.570578691184429,-5.3001622498647745,-0.27559238083322946,0.99,54376145173,3105433762),
	 ('600519','2010-05-04',74.07873287146465,74.4549433282695,74.98742582097789,73.44206902148723,4142296,308414400,2.0692862125087106,-0.30225528946757857,-0.22572627408291623,0.25,121410432000,943800000),
	 ('600519','2010-05-05',73.96876366101401,75.69933176231629,75.95978515548889,73.67937100193336,5846555,442580281,3.0628109452736427,1.6713308457711507,1.2443884340467974,0.36,123439602000,943800000),
	 ('600519','2010-05-06',75.82087667913017,73.70831026784143,75.82087667913017,73.67937100193336,4879184,359636400,2.828962458903583,-2.6301705023319775,-1.9910214944748645,0.3,120192930000,943800000);
INSERT INTO public.stock_hist_adj (stock_code,"date","open","close",high,low,volume,amount,amplitude,change_percent,"change",turnover_rate,mkt_cap,total_shares) VALUES
	 ('600519','2010-05-07',72.92695008832366,75.24787921415047,75.45624192868856,72.63755742924302,5400102,406346254.99999994,3.8241067923046894,2.0887318413820055,1.5395689463090463,0.33,122703438000,943800000),
	 ('600519','2010-05-10',76.39966199729146,77.29099138725987,78.71480326993665,76.39966199729146,11436538,883941322,3.076686408737785,2.7151757557111087,2.0431121731093924,0.7,126035052000,943800000),
	 ('600519','2010-05-11',78.47750128949053,77.36044562543921,78.71480326993665,76.88005381136534,5810790,449525311.99999994,2.373820578103928,0.08986071589035821,0.06945423817934682,0.36,126148308000,943800000),
	 ('600519','2010-05-12',77.14629505771954,77.0826286727218,77.55723263361406,75.24209136096887,3739383,288241474,2.9926679634894464,-0.359120155618724,-0.2778169527174157,0.23,125695284000,943800000),
	 ('600519','2010-05-13',77.11156793862986,78.0607758604144,78.54116767448826,77.11156793862986,4673581,364823350.00000006,1.8546328277519077,1.2689593031986837,0.9781471876925991,0.29,127290306000,943800000),
	 ('600519','2010-05-14',78.066563713596,78.1070786858673,78.77846965493441,77.55723263361406,3131731,244610370,1.564469489137698,0.05931637873507049,0.04630282545289788,0.19,127365810000,943800000),
	 ('600519','2010-05-17',77.96238235632697,75.12633429733661,77.96238235632697,75.01057723370434,3048453,229019120.00000003,3.7791774731382066,-3.8162282326787587,-2.980744388530681,0.19,122505240000,943800000),
	 ('600519','2010-05-18',75.24209136096887,75.30575774596662,75.80351311958532,73.0311314455927,4498559,338767407,3.690292758089355,0.23882896764252892,0.17942344863000415,0.28,122797818000,943800000),
	 ('600519','2010-05-19',75.53148402004952,75.14369785688145,75.93663374276242,74.0960964310095,1865804,140203417,2.444085773576197,-0.21520252094382641,-0.162059889085171,0.11,122533554000,943800000),
	 ('600519','2010-05-20',74.92375943598014,76.09869363184758,77.169446470446,74.66909389598918,3928918,298985520,3.3274281753061894,1.2708927058460966,0.954995774966136,0.24,124090824000,943800000);
INSERT INTO public.stock_hist_adj (stock_code,"date","open","close",high,low,volume,amount,amplitude,change_percent,"change",turnover_rate,mkt_cap,total_shares) VALUES
	 ('600519','2010-05-21',74.8948201700721,77.67877755042794,77.90450382451084,74.35654982418208,4723859,366943561,4.662306054152717,2.0763614237907047,1.5800839185803568,0.29,126667398000,943800000),
	 ('600519','2010-05-24',78.13023009859376,78.69743971039182,79.00419592901731,77.73086822906245,5145777,404959451,1.6392221145965336,1.311377691677216,1.0186621599638812,0.32,128328486000,943800000),
	 ('600519','2010-05-25',78.48328914267213,75.96557300867049,78.48328914267213,75.67618034958984,3809875,289419375,3.5669633007280925,-3.4713539751415743,-2.73186670172133,0.23,123873750000,943800000),
	 ('600519','2010-05-26',76.11026933821081,76.36493487820178,76.78166030727792,75.33469701187467,1904851,145463849.99999997,1.9047619047619087,0.525714285714278,0.3993618695312904,0.12,124524972000,943800000),
	 ('600519','2010-05-31',77.26783997453342,76.3302077591121,78.26335072177085,76.3302077591121,4068866,310577400,2.5314536910717136,-0.04547521600727941,-0.034727119089680514,0.25,124468344000,943800000),
	 ('600519','2010-06-01',76.25496566775114,76.76429674773308,77.24468856180697,75.53148402004952,4064720,312025338,2.2444646648468356,0.5686988171064747,0.4340889886209851,0.25,125176194000,943800000),
	 ('600519','2010-06-02',76.72378177546179,77.64983828451987,77.78874676087858,76.197087135935,3781886,293662824,2.0734373821910603,1.153585161728118,0.8855415367867892,0.23,126620208000,943800000),
	 ('600519','2010-06-03',78.13023009859376,78.1533815113202,79.00419592901731,77.20996144271729,4310579,336886347,2.31067382230173,0.6484794275491973,0.5035432268003319,0.26,127441314000,943800000),
	 ('600519','2010-06-04',78.09550297950408,79.94182814443862,80.10388803352377,77.67877755042794,5189489,414857232.00000006,3.103014145004804,2.2883803599200148,1.7884466331184115,0.32,130357656000,943800000),
	 ('600519','2010-06-07',79.29358858809796,81.64345697983283,82.343787214808,78.71480326993665,6587071,537791250,4.539530842745446,2.128583840139007,1.7016288353942173,0.4,133132428000,943800000);
INSERT INTO public.stock_hist_adj (stock_code,"date","open","close",high,low,volume,amount,amplitude,change_percent,"change",turnover_rate,mkt_cap,total_shares) VALUES
	 ('600519','2010-06-08',81.64345697983283,81.09939878076122,82.1180609407251,80.45115922442055,2487105,201702740,2.04168438962145,-0.6663830993903217,-0.544058199071614,0.15,132245256000,943800000),
	 ('600519','2010-06-09',81.15727731257734,81.85181969437089,82.53478636980122,81.07624736803477,3119291,255319667.99999994,1.7984584641735408,0.9277761918355448,0.7524209136096687,0.19,133472196000,943800000),
	 ('600519','2010-06-10',81.84024398800767,81.8113047220996,82.53478636980122,81.33670076120734,2035470,166524435,1.4637250742469199,-0.049497949370658136,-0.04051497227128209,0.12,133406130000,943800000),
	 ('600519','2010-06-11',81.9386374920951,80.28331148215378,82.47690783798511,80.19649368442958,3381737,271497083,2.787407145383809,-1.8677042801556416,-1.527993239945829,0.21,130914498000,943800000),
	 ('600519','2010-06-17',80.56691628805281,78.99262022265408,80.7347640303196,78.89422671856666,2163842,170927552,2.2925528080167363,-1.6076706798356266,-1.2906912594996953,0.13,128809824000,943800000),
	 ('600519','2010-06-18',78.72059112311827,76.5501461800134,79.1778315244657,75.82666453231177,3473136,265869051.99999997,4.242379835873407,-3.0920281359906228,-2.442474042640683,0.21,124826988000,943800000),
	 ('600519','2010-06-21',76.63117612455599,77.81189817360503,77.84662529269471,75.93663374276242,3274789,254817576,2.495085437774081,1.6482685619234827,1.2617519935916306,0.2,126884472000,943800000),
	 ('600519','2010-06-22',77.1289314981747,76.5096312077421,77.52250551452438,76.05239080639468,3590105,274677601,1.8893186551621544,-1.6736090449271106,-1.302266965862927,0.22,124760922000,943800000),
	 ('600519','2010-06-23',76.39966199729146,76.22602640184307,76.90899307727341,76.0639665127579,2213774,168747209.99999997,1.1044708374309846,-0.3706785687268261,-0.2836048058990315,0.14,124298460000,943800000),
	 ('600519','2010-06-24',76.34757131865695,75.22472780142402,76.67169109682727,75.05688005915725,4206050,316398968,2.1184510250569466,-1.313591495823843,-1.001298600419048,0.26,122665686000,943800000);
INSERT INTO public.stock_hist_adj (stock_code,"date","open","close",high,low,volume,amount,amplitude,change_percent,"change",turnover_rate,mkt_cap,total_shares) VALUES
	 ('600519','2010-06-25',75.12633429733661,75.54305972641275,75.82087667913017,74.56491253872015,3284638,248131572.00000003,1.6696160652458207,0.42317457874895775,0.3183319249887262,0.2,123184776000,943800000),
	 ('600519','2010-06-28',75.35784842460112,74.09030857782787,75.36942413096435,73.97455151419562,2560017,189672416.99999997,1.8464603125957602,-1.9230769230769496,-1.4527511485848805,0.16,120815838000,943800000),
	 ('600519','2010-06-29',74.37970123690853,73.08322212422722,74.88903231689046,72.64334528242463,4800225,350815941,3.0310132020935754,-1.3592688071244294,-1.0070864536006496,0.29,119173626000,943800000),
	 ('600519','2010-06-30',72.92695008832366,73.71409812102304,73.79512806556562,72.72437522696721,3079553,227006464.00000003,1.465114437316869,0.8632295873921052,0.6308759967958224,0.19,120202368000,943800000),
	 ('600605','2010-05-04',6.889895279326238,7.0890252006940475,7.221778481605922,6.883257615280643,1546930,10966224,4.784240150093829,0.1876172607879911,0.013275328091187255,0.7,1573640243,147344592),
	 ('600605','2010-05-05',7.035923888329298,7.4142707389281375,7.434183731064918,7.035923888329298,2353238,17447540,5.617977528089884,4.588014981273405,0.32524553823408997,1.06,1645839093,147344592),
	 ('600605','2010-05-06',7.4142707389281375,7.1421265130587965,7.467372051292887,7.12885118496761,1531262,10936463.999999998,4.565801253357202,-3.67054610564011,-0.27214422586934095,0.69,1585427810,147344592),
	 ('600605','2010-05-07',7.035923888329298,7.241691473742702,7.434183731064918,6.909808271463018,1307388,9467698.0,7.342007434944227,1.3940520446096738,0.09956496068390575,0.59,1607529499,147344592),
	 ('600605','2010-05-10',7.235053809697109,7.274879793970671,7.387720082745764,6.777054990551146,2013058,14644752.000000002,8.432630614115489,0.45829514207149674,0.03318832022796858,0.91,1614896728,147344592),
	 ('600605','2010-05-11',7.367807090608982,6.989460240010142,7.427546067019325,6.969547247873361,1751520,12242178,6.2956204379562,-3.92335766423359,-0.2854195539605291,0.79,1551538554,147344592);
INSERT INTO public.stock_hist_adj (stock_code,"date","open","close",high,low,volume,amount,amplitude,change_percent,"change",turnover_rate,mkt_cap,total_shares) VALUES
	 ('600605','2010-05-12',6.969547247873361,6.737229006277583,7.049199216420485,6.551374413000959,1817055,12241915,7.122507122507127,-3.6087369420702613,-0.25223123373255874,0.82,1495547609,147344592),
	 ('600605','2010-05-13',6.743866670323176,6.883257615280643,6.903170607417425,6.577925069183334,1375936,9470920.999999998,4.827586206896561,2.1674876847290476,0.1460286090030598,0.62,1527963419,147344592),
	 ('600605','2010-05-14',6.883257615280643,6.856706959098269,7.00273556810133,6.790330318642332,1175865,8062565.000000001,3.0858244937319217,-0.3857280617164741,-0.026550656182373622,0.53,1522069635,147344592),
	 ('600605','2010-05-17',6.896532943371831,6.305780843313993,6.896532943371831,6.305780843313993,1858334,11718249.999999998,8.615682478218787,-8.0348499515973,-0.550926115784276,0.84,1399773624,147344592),
	 ('600605','2010-05-18',6.305780843313993,6.292505515222807,6.445171788271462,5.9871729691254965,1655402,10416624.000000002,7.263157894736866,-0.21052631578945802,-0.013275328091186367,0.75,1396826732,147344592),
	 ('600605','2010-05-19',6.186302890493308,6.37215748376993,6.438534124225867,6.186302890493308,1064682,6784320.0,4.008438818565384,1.265822784810117,0.07965196854712353,0.48,1414508083,147344592),
	 ('600605','2010-05-20',6.246041866903651,6.345606827587556,6.524823756818585,6.246041866903651,1310099,8313376.000000001,4.374999999999995,-0.4166666666666635,-0.02655065618237451,0.59,1408614300,147344592),
	 ('600605','2010-05-21',6.0469119455358395,6.438534124225867,6.504910764681805,6.0469119455358395,1090745,7022799.999999999,7.217573221757345,1.4644351464435035,0.09292729663831079,0.49,1429242542,147344592),
	 ('600605','2010-05-24',6.538099084909772,6.717316014140801,6.763779662459957,6.425258796134679,2052077,13784451.999999998,5.257731958762882,4.32989690721649,0.27878188991493413,0.92,1491127271,147344592),
	 ('600605','2010-05-25',6.690765357958427,6.6509393736848645,6.75050433436877,6.571287405137741,1253152,8334636.0,2.6679841897233203,-0.9881422924901113,-0.06637664045593628,0.56,1476392812,147344592);
INSERT INTO public.stock_hist_adj (stock_code,"date","open","close",high,low,volume,amount,amplitude,change_percent,"change",turnover_rate,mkt_cap,total_shares) VALUES
	 ('600605','2010-05-26',6.637664045593677,6.7040406860496145,6.730591342231989,6.611113389411304,817607,5481270.0,1.796407185628729,0.7984031936127819,0.05310131236474991,0.37,1488180379,147344592),
	 ('600605','2010-05-27',6.7040406860496145,6.803605646733519,6.8235186388703,6.670852365821647,1491037,10144425,2.2772277227722535,1.4851485148514805,0.09956496068390486,0.67,1510282068,147344592),
	 ('600605','2010-05-28',6.8235186388703,6.737229006277583,6.916445935508612,6.67749002986724,1086075,7317135.0,3.512195121951219,-0.9756097560975537,-0.06637664045593628,0.49,1495547609,147344592),
	 ('600605','2010-05-31',6.737229006277583,6.511548428727398,6.7571419984143635,6.504910764681805,1017527,6625674.000000001,3.7438423645320045,-3.349753694581282,-0.2256805775501851,0.46,1445450448,147344592),
	 ('600605','2010-06-01',6.438534124225867,6.332331499496368,6.504910764681805,6.179665226447714,1498720,9490392.0,4.994903160040785,-2.7522935779816646,-0.17921692923103016,0.68,1405667408,147344592),
	 ('600605','2010-06-02',6.37215748376993,6.438534124225867,6.471722444453835,6.252679530949244,752674,4846120.0,3.459119496855341,1.6771488469601692,0.10620262472949893,0.34,1429242542,147344592),
	 ('600605','2010-06-03',6.451809452317055,6.365519819724336,6.524823756818585,6.365519819724336,1064983,6779171.0,2.4742268041237208,-1.1340206185566994,-0.07301430450153035,0.48,1413034637,147344592),
	 ('600605','2010-06-04',6.259317194994837,6.438534124225867,6.451809452317055,6.259317194994837,548084,3528859.9999999995,3.023983315954131,1.1470281543274228,0.07301430450153035,0.25,1429242542,147344592),
	 ('600605','2010-06-07',6.312418507359587,6.558012077046554,6.710678350095208,6.259317194994837,1422790,9330672.000000002,7.010309278350518,1.8556701030927973,0.11947795282068707,0.64,1455764569,147344592),
	 ('600605','2010-06-08',6.558012077046554,6.637664045593677,6.730591342231989,6.511548428727398,1469041,9751000.0,3.340080971659914,1.214574898785416,0.07965196854712353,0.66,1473445920,147344592);
INSERT INTO public.stock_hist_adj (stock_code,"date","open","close",high,low,volume,amount,amplitude,change_percent,"change",turnover_rate,mkt_cap,total_shares) VALUES
	 ('600605','2010-06-09',6.810243310779113,6.763779662459957,6.810243310779113,6.577925069183334,1507609,10197132.999999998,3.500000000000007,1.8999999999999924,0.12611561686627937,0.68,1501441392,147344592),
	 ('600605','2010-06-10',6.763779662459957,6.803605646733519,6.863344623143862,6.67749002986724,1263848,8598725.0,2.7477919528949877,0.5888125613346505,0.039825984273562653,0.57,1510282068,147344592),
	 ('600605','2010-06-11',6.803605646733519,6.631026381548084,6.863344623143862,6.62438871750249,1027922,6816177.0,3.512195121951219,-2.5365853658536524,-0.1725792651854352,0.46,1471972474,147344592),
	 ('600605','2010-06-17',6.7571419984143635,6.6509393736848645,6.7571419984143635,6.631026381548084,753578,5012004.0,1.9019019019018941,0.3003003003002913,0.01991299213678044,0.34,1476392812,147344592),
	 ('600605','2010-06-18',6.37215748376993,6.551374413000959,6.7571419984143635,6.37215748376993,817155,5353487.999999999,5.788423153692611,-1.497005988023961,-0.09956496068390575,0.37,1454291123,147344592),
	 ('600605','2010-06-21',6.451809452317055,6.710678350095208,6.743866670323176,6.451809452317055,856627,5748546.0,4.457953394123601,2.4316109422492493,0.15930393709424884,0.39,1489653825,147344592),
	 ('600605','2010-06-22',6.7571419984143635,6.7571419984143635,6.790330318642332,6.664214701776052,749511,5064550.0,1.8793273986152381,0.6923837784371923,0.04646364831915584,0.34,1499967947,147344592),
	 ('600605','2010-06-23',6.7040406860496145,6.604475725365709,6.743866670323176,6.538099084909772,620550,4098404.9999999995,3.0451866404715098,-2.2593320235756416,-0.15266627304865477,0.28,1466078690,147344592),
	 ('600605','2010-06-24',6.604475725365709,6.631026381548084,6.684127693912833,6.584562733228928,430724,2856141.0,1.5075376884422065,0.40201005025126674,0.0265506561823754,0.19,1471972474,147344592),
	 ('600605','2010-06-25',6.664214701776052,6.478360108499429,6.664214701776052,6.438534124225867,668157,4328560.0,3.4034034034034044,-2.302302302302305,-0.15266627304865477,0.3,1438083218,147344592);
INSERT INTO public.stock_hist_adj (stock_code,"date","open","close",high,low,volume,amount,amplitude,change_percent,"change",turnover_rate,mkt_cap,total_shares) VALUES
	 ('600605','2010-06-28',6.504910764681805,6.3190561714051805,6.5912003972745214,6.285867851177213,673128,4253536.0,4.713114754098353,-2.459016393442632,-0.15930393709424884,0.3,1402720516,147344592),
	 ('600605','2010-06-29',6.4318964601802735,5.887608008441592,6.438534124225867,5.84778202416803,894441,5266119.0,9.348739495798313,-6.827731092436973,-0.4314481629635889,0.4,1306946531,147344592),
	 ('600605','2010-06-30',5.887608008441592,5.715028743256156,5.887608008441592,5.4959858297515645,1395973,7978026.0,6.651634723788052,-2.9312288613303203,-0.1725792651854352,0.63,1268636937,147344592);
            """
            db.execute(text(sql1))
            sql4 = """
            INSERT INTO public.stock_info (stock_code,stock_name,listing_date,market) VALUES
                ('000001','平安银行','1991-04-03 00:00:00.000','SZ'),
                ('600605','汇通能源','1992-03-27 00:00:00.000','SH'),
                ('600519','贵州茅台','2001-08-27 00:00:00.000','SH');
            """
            db.execute(text(sql4))
            sql5 = """
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('600605','2024-09-30',1386000000,1618000000,209000000,22203800,98417200,36915200,102000000,68152400,57578200,2327700.0),
	 ('600605','2024-06-30',1370000000,1638000000,241000000,27319000,82092500,25066700,67066700,43327600,69722800,2138500.0),
	 ('600605','2024-03-31',1306000000,1504000000,196000000,2656300.0,11370600,14728400,32729300,20218300,3322000.0,29300.0),
	 ('600605','2023-12-31',1294000000,1501000000,204000000,3040700.0,56454000,17742300,130000000,117000000,290000000,101600.0),
	 ('600605','2023-09-30',1280000000,3019000000,1732000000,2861600.0000000005,43346400,20624899.999999996,87610500,71238100,265000000,173000.0),
	 ('600605','2023-06-30',1222000000,2802000000,1572000000,3243800.0,33036000,13535400,50321500,41285100,211000000,133800.0),
	 ('600605','2023-03-31',1132000000,2515000000,1366000000,10396700,7149000.0,8303200.000000001,24244300,19011400,-217000000,94600.00000000001),
	 ('600605','2022-12-31',1125000000,2288000000,1146000000,10396700,9268000.0,16716099.999999998,108000000,92101900,357000000,242000.0),
	 ('600605','2022-09-30',1122000000,2128000000,859000000,138000000,18584700,21124600,70242300,49143100.00000001,200000000,242000.0),
	 ('600605','2022-06-30',1115000000,2162000000,899000000,138000000,11510700,14019100,46862100,32761600,105000000,242000.0);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('600605','2022-03-31',1124000000,2155000000,614000000,405999999.99999994,2899700.0000000005,2287300.0,22334300,19680300,42755600.00000001,218000.0),
	 ('600605','2021-12-31',1121000000,2064000000,525000000,407000000,60267400,12759900,112999999.99999999,100000000,-458000000,3931500.0),
	 ('600605','2021-09-30',875000000,1703000000,361000000,453000000,52684799.99999999,19961300,84203400,64657100,-625000000,NULL),
	 ('600605','2021-06-30',815000000,1626000000.0000002,344000000,454000000,27232300,11958800.000000002,60090500,48302100,-696000000,NULL),
	 ('600605','2021-03-31',782000000,1538000000,704000000,51969900,7727900.0,10623400,30483900,19890300,-577000000,NULL),
	 ('600605','2020-12-31',775000000,859000000,83734500,546800.0,49721600,49534200,92585700,50652100,-639000000,3168200.0),
	 ('600605','2020-09-30',762000000,914000000,153000000,NULL,37987100,30289100,66090200.00000001,44208800,-126000000,3055700.0),
	 ('600605','2020-06-30',753000000,1126000000,374000000,NULL,29189899.999999996,17656800,42087800,30804400,-202999999.99999997,2892000.0),
	 ('600605','2020-03-31',726000000,776000000,49278000,NULL,12183800.000000002,12464200,19664500,11830200,-6367300.0,3016200.0),
	 ('600605','2019-12-31',711000000,768000000,57450400,NULL,23069500,24152900,120000000,101000000,258000000,2890800.0);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('600605','2019-09-30',693000000,761000000,67387600,500000.0,5475400.0,12783800.000000002,95228700.00000001,85559400,432000000,2829500.0),
	 ('600605','2019-06-30',687000000,751000000,63454399.99999999,500000.0,-1146200.0,3506900.0,71617200,69358100,423000000.00000006,2744400.0),
	 ('600605','2019-03-31',689000000,1093000000,274000000,129000000,-5053000.0,-5288700.0,35824300,41452800,-17694500,2708000.0),
	 ('600605','2018-12-31',722000000,1248000000,397000000,129000000,22546700,26415500,2063000000,2030999999.9999998,453000000,9299000.0),
	 ('600605','2018-09-30',683000000,1215000000,347000000,184000000,21331300,24664300,1745000000,1720000000,-71593200,9036900.0),
	 ('600605','2018-06-30',684000000,1218000000,350000000,184000000,22044800,25025700,1209000000,1183000000,80381900,4417400.0),
	 ('600605','2018-03-31',684000000,1240000000,372000000,184000000,10437900,11204300,395000000,383000000,-92285900,3089300.0),
	 ('600605','2017-12-31',673000000,1238000000,380000000,184000000,29375300.000000004,29689100,2473000000,2443000000,29124200,7227100.0),
	 ('600605','2017-09-30',584000000,1169000000,247000000.00000003,338000000,14198200,14012500,1826000000.0000002,1811000000,23869699.999999996,4103900.0),
	 ('600605','2017-06-30',581000000,1218000000,400000000,238000000,11251000,11934400,1216000000,1203000000,35389900,2948300.0);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('600605','2017-03-31',582000000,1237000000,417000000,238000000,5342400.0,5655800.0,528000000,522000000,19818100,1537300.0),
	 ('600605','2016-12-31',577000000,1238000000,424000000,238000000,24822600.000000004,25369500,2149000000,2123999999.9999998,39996900,19037800),
	 ('600605','2016-09-30',575000000,1251000000,387000000,290000000,22459200,26553300,1660000000.0000002,1632999999.9999998,26000.0,15944300),
	 ('600605','2016-06-30',567000000,1202000000,346000000,290000000,14337600,16978900,917000000,900000000,-51842700.00000001,15746099.999999998),
	 ('600605','2016-03-31',559000000,1270000000,422000000,290000000,3333300.0,4495900.0,306000000,301000000,-42477400,15103599.999999998),
	 ('600605','2015-12-31',555000000,1262000000,417000000,290000000,10275100,10489900,1842000000.0000002,1830999999.9999998,16178300,246000000),
	 ('600605','2015-09-30',488000000,1238000000,341000000,409000000,5582800.0,6136500.0,1225000000,1217000000,168299.99999999997,271000000),
	 ('600605','2015-06-30',490000000.00000006,1197000000,329000000,378000000,7478500.0,7740599.999999999,688000000,680000000,18157700,148000000),
	 ('600605','2015-03-31',488000000,1005000000.0000001,391000000,125000000,3116100.0,3902400.0,259000000,254999999.99999997,-7736000.0,42278000),
	 ('600605','2014-12-31',484999999.99999994,927999999.9999999,317000000,125000000,7958200.000000001,6715400.0,2123000000,2116000000,146000000,56274200);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('600605','2014-09-30',480000000,936000000,315000000,141000000,2919300.0,2956400.0,1603000000,1599000000,95792700,3142600.0),
	 ('600605','2014-06-30',483000000,943000000,320000000,141000000,3216500.0,2767500.0,1048000000,1044999999.9999999,113999999.99999999,739700.0),
	 ('600605','2014-03-31',482000000,894000000,272000000,141000000,2400800.0,867099.9999999999,538000000,537000000,81378000,403500.0),
	 ('600605','2013-12-31',480000000,861000000,241000000,141000000,6658700.0,2105300.0,2195000000,2192000000,-27415900,3507300.0),
	 ('600605','2013-09-30',476999999.99999994,893000000,271000000,146000000,3572600.0,-1201700.0,1607999999.9999998,1609000000,22997399.999999996,2627000.0),
	 ('600605','2013-06-30',480000000,852999999.9999999,223000000,150000000,6677900.0,2896200.0,1032000000,1028999999.9999999,2172800.0,1708300.0000000002),
	 ('600605','2013-03-31',476000000,799000000,173000000,150000000,876600.0,264700.0,483000000,483000000,-2229100.0,464000.0),
	 ('600605','2012-12-31',475000000,865000000,239000000,150000000,6601000.0,-6169000.0,1887000000,1893000000,92645100,28790700),
	 ('600605','2012-09-30',471000000,788000000,157000000,160000000,2113900.0,-4644200.0,1383000000,1388000000,51297100,27365100.000000004),
	 ('600605','2012-06-30',475000000,871000000.0000001,184000000,212000000,6552700.0,3045100.0,949000000,947000000.0000001,53755100,12292600);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('600605','2012-03-31',470000000,824000000,190000000,164000000,975100.0,-2724800.0,536000000.00000006,539000000,17840300,6236500.0),
	 ('600605','2011-12-31',469000000.00000006,808000000,178000000,161000000,5875400.0,6974200.0,2126000000.0000002,2119000000.0000002,-23402600.000000004,44147700.00000001),
	 ('600605','2011-09-30',466000000,797000000,163000000,168000000,6118099.999999999,2542800.0,1729000000,1727000000,24205700,37430200),
	 ('600605','2011-06-30',469000000.00000006,798000000,164000000,165000000,8882000.0,5747500.0,1123000000,1118000000,-29867800.000000004,32379100),
	 ('600605','2011-03-31',461000000.00000006,822000000.0000001,198000000,164000000,983600.0,1095300.0,559000000,558000000,-2264900.0,17829700),
	 ('600605','2010-12-31',459999999.99999994,819000000,198000000,161000000,4160600.0,4153700.0,1517000000,1522000000,-3708600.0,352000000),
	 ('600605','2010-09-30',364000000,658000000,169000000,126000000,3577900.0,1951399.9999999998,1229000000,1229000000,-34647700,200999999.99999997),
	 ('600605','2010-06-30',367000000,672000000,180000000,126000000,6698300.0,5440200.0,821000000.0000001,817000000,-27783800,99621500),
	 ('600605','2010-03-31',361000000,655000000,166000000,128000000,865100.0,-1154200.0,396000000,397000000,-7258900.0,33181200),
	 ('600605','2009-12-31',360000000,559000000,193000000,5713099.999999999,22622399.999999996,-5031100.0,1304000000,1326000000,61520300,795100.0);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('600605','2009-09-30',340000000,554000000,208000000,5713099.999999999,2824500.0,-5855900.0,936999999.9999999,944000000,-12944200,645400.0000000001),
	 ('600605','2009-06-30',345000000,572000000,221000000,5713099.999999999,7535400.0,1308400.0,611000000,610000000,12348900.000000002,49400.00000000001),
	 ('600605','2009-03-31',338000000,570000000,225999999.99999997,5713099.999999999,796100.0,2005100.0,267000000,265000000,-19957500,21900.0),
	 ('600605','2008-12-31',338000000,557000000,214000000,5713099.999999999,42589200,-3638000.0,1008000000,1083000000,-183000000,9303900.0),
	 ('600605','2008-09-30',297000000,603000000,300000000,5713099.999999999,1968300.0000000002,-10079400,704000000,715000000,-81985200,9102700.0),
	 ('600605','2008-06-30',296000000,580000000,278000000,5713099.999999999,1426399.9999999998,-4375200.0,457000000,462000000,-49370200.00000001,8983100.0),
	 ('600605','2008-03-31',296000000,557000000,256000000,6088600.0,893199.9999999999,-3930299.9999999995,156000000,160000000,-64233600,7749800.0),
	 ('600605','2007-12-31',295000000,584000000,288000000,1380100.0,36778200,-37732100,909000000,984000000,-6742700.0,91479900),
	 ('600605','2007-09-30',245000000.00000003,609000000,362000000,1380100.0,3147100.0,1051200.0,719000000,718000000,-120000000,2743700.0),
	 ('600605','2007-06-30',244000000,618000000,373000000,1380100.0,1941300.0,1208100.0,534000000,533000000,-152000000,60400.0);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('600605','2007-03-31',243000000.00000003,616000000,371000000,1380100.0,701300.0,1034599.9999999999,198000000,197000000,-130000000,20200.0),
	 ('600605','2006-12-31',242000000,701000000,458000000,1380100.0,5604100.0,-1716399.9999999998,809000000,811000000,-21875000,496900.0),
	 ('600605','2006-09-30',341000000,726000000,384000000,500000.0,2326500.0,2053600.0000000002,580000000,579000000,-47353900,546900.0),
	 ('600605','2006-06-30',341000000,670000000,329000000,500000.0,1522000.0,948500.0,348000000,348000000,-60385400,496800.0),
	 ('600605','2006-03-31',340000000,666000000,325000000,500000.0,864500.0,1044599.9999999999,112999999.99999999,112000000.00000001,-51458900,270800.0),
	 ('600605','2005-12-31',339000000,692000000,353000000,500000.0,6086500.0,-167000000,868000000,1042000000,-159000000,7174900.0),
	 ('600605','2005-09-30',324000000,856000000,530999999.99999994,500000.0,5182000.0,-44050200.00000001,493000000,548000000,-58365700,5356300.0),
	 ('600605','2005-06-30',323000000,802000000,479000000,500000.0,3516200.0,-16151900,344000000,369000000,-64893900,5306799.999999999),
	 ('600605','2005-03-31',321000000,876000000,555000000,500000.0,1803400.0,-9887700.0,184000000,198000000,16207400,4221800.0),
	 ('600605','2004-12-31',319000000,791000000,472000000,500000.0,4196100.0,-58928100.00000001,737000000,807000000,-166000000,611900.0);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('600605','2004-09-30',322000000,930000000.0000001,607000000,500000.0,7267700.0,-15674500,420000000,446000000,-36274400,253400.0),
	 ('600605','2004-06-30',319000000,923000000,604000000,500000.0,3663399.9999999995,-8831500.0,268000000.00000003,285000000,-105000000,194200.00000000003),
	 ('600605','2004-03-31',317000000,795000000,478000000,500000.0,1429199.9999999998,-2180700.0,108000000,113999999.99999999,-115999999.99999999,431800.0),
	 ('600605','2003-12-31',315000000,734000000,418000000,500000.0,7081400.0,-16772700,517000000,548000000,23236900,1856399.9999999998),
	 ('600605','2003-09-30',330000000,765000000,432000000,636000.0,21865900,14020200,408000000,403000000,41212500,995699.9999999999),
	 ('600605','2003-06-30',321000000,645000000,321000000,636000.0,12591199.999999998,7605500.0,222000000.00000003,220000000.00000003,-31277000,787200.0),
	 ('600605','2003-03-31',309000000,622000000,305000000,636000.0,1004900.0,-5188500.0,47944600,55139799.99999999,5613500.0,515800.0),
	 ('600605','2002-12-31',308000000,624000000,302000000,4836000.0,6025000.0,-3884100.0000000005,183000000,202999999.99999997,3257500.0,2253800.0),
	 ('600605','2002-06-30',317000000,622000000,292000000,4836000.0,7841100.0,967200.0,91322600,96502800,2450700.0,702000.0),
	 ('600605','2001-12-31',302000000,592000000,282000000,4836000.0,9130900.0,762500.0,195000000,208000000,5019800.0,3083500.0);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('600605','2001-06-30',315000000,612000000,282000000,9471400.0,13393599.999999998,10747800,108000000,106000000,14259600,617800.0),
	 ('600605','2000-12-31',313000000,608000000,279000000,9406000.0,8036600.0,-11654600,220000000.00000003,243000000.00000003,5034700.0,2142600.0),
	 ('600605','2000-06-30',316000000,639000000,305000000,9429200.0,3352500.0,-1300900.0,114999999.99999999,122000000,-3959100.0000000005,2207200.0),
	 ('600605','1999-12-31',313000000,637000000,305000000,9494200.0,31943600,12657700,271000000,278000000,28298300,2147700.0),
	 ('600605','1998-12-31',281000000,599000000,298000000,10992300,24778200,-1446500.0,352000000,366000000,-1245200.0,4739600.0),
	 ('600519','2024-09-30',237709000000,286771000000,38724000000,359000000,60828000000,83997000000,123123000000,39193000000,44421000000,2874000000),
	 ('600519','2024-06-30',218576000000.00003,279207000000,50807000000,356000000,41696000000,57551000000,83451000000,25954000000.000004,36622000000,1531000000),
	 ('600519','2024-03-31',239732000000.00003,285525000000,36627000000,361000000,24065000000,33157000000,46485000000,13357000000,9187000000,796000000),
	 ('600519','2023-12-31',215669000000,272700000000,48698000000,346000000,74734000000,103708999999.99998,150560000000,46923000000,66592999999.99999,2620000000),
	 ('600519','2023-09-30',217809000000,262076000000.00003,36664000000,394000000,52876000000,73171000000,105316000000.00002,32191000000.000004,50002000000,1945000000);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('600519','2023-06-30',200916000000,241604000000,31955000000,401000000,35980000000,49892000000,70987000000,21125000000,30387000000,1405000000),
	 ('600519','2023-03-31',218276000000.00003,258391000000,31429000000.000004,499000000,20795000000,28686000000,39379000000,10718000000,5245000000,906000000),
	 ('600519','2022-12-31',197480000000,254501000000.00003,49066000000,497000000,62716999999.99999,87880000000,127554000000,39763000000,36699000000,5307000000),
	 ('600519','2022-09-30',206709000000,247757000000.00003,34001000000,310000000,44400000000,61962000000,89786000000,27889999999.999996,9405000000,2639000000),
	 ('600519','2022-06-30',192103000000,239848999999.99997,41132000000,261000000,29794000000,41635000000,59444000000.00001,17855000000,-11163900.000000002,1686000000),
	 ('600519','2022-03-31',206783000000,251302000000,36107000000,287000000,17245000000,24027000000,33187000000,9187000000,-6876000000.000001,1223000000),
	 ('600519','2021-12-31',189539000000,255167999999.99997,57914000000,296000000,52460000000,74751000000,109464000000.00002,34790000000,64029000000,3409000000.0000005),
	 ('600519','2021-09-30',174348000000,224702000000,43447000000,440000000.00000006,37266000000,53023000000,77053000000,24083000000,36752000000,2251000000),
	 ('600519','2021-06-30',161738000000,212869000000,44877000000,426999999.99999994,24654000000,35072000000,50722000000,15685000000,21719000000,1854000000),
	 ('600519','2021-03-31',175274000000,215217999999.99997,32329000000.000004,400000000,13954000000,19714000000,28064999999.999996,8356000000,-1485000000,1411000000);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('600519','2020-12-31',161323000000,213396000000,45674000000,1457500.0,46697000000,66635000000,97993000000,31377000000,51669000000.00001,2089999999.9999998),
	 ('600519','2020-09-30',148452000000,184579000000,30406000000,1812400.0,33827000000,47986000000,69575000000,21608000000,25111000000,1614999999.9999998),
	 ('600519','2020-06-30',137227000000,172198000000,29605000000,74521900,22602000000,32081000000,45634000000,13572000000,12621000000,964000000),
	 ('600519','2020-03-31',149104000000,181625000000,25818000000,71998400,13094000000,18561000000,25298000000,6738000000,2303000000,413999999.99999994),
	 ('600519','2019-12-31',136009999999.99998,183042000000,41093000000,72692600,41206000000,59041000000,88854000000,29818000000,45211000000,3149000000),
	 ('600519','2019-09-30',125258000000,162550000000,31679000000.000004,48945600.00000001,30455000000,43312000000,63509000000,20087000000,27314999999.999996,2028000000),
	 ('600519','2019-06-30',114755000000,165122000000,45437000000,77674700,19951000000,28398000000,41173000000,12781000000,24087000000,1125000000),
	 ('600519','2019-03-31',124058000000,159888000000,30566000000.000004,NULL,11221000000,15996000000,22481000000,6484000000,1189000000,609000000),
	 ('600519','2018-12-31',112839000000.00002,159847000000,42438000000,NULL,35204000000,51342999999.99999,77199000000,25866000000.000004,41385000000,1607000000),
	 ('600519','2018-09-30',102370000000,147148000000,40975000000,15570000,24734000000,35838000000,54969000000.00001,19131000000,28220999999.999996,1016000000);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('600519','2018-06-30',93398000000,129915000000.00002,33395000000,15570000,15763999999.999998,22880000000,35251000000,12372000000,17735000000,717000000),
	 ('600519','2018-03-31',99958000000,134405000000,29239999999.999996,15570000,8506999999.999999,12178000000,18395000000,6218000000,4936000000,575000000),
	 ('600519','2017-12-31',91452000000,134609999999.99998,38575000000,15570000,27079000000.000004,38940000000,61063000000,22123000000,22153000000,1125000000),
	 ('600519','2017-09-30',84356000000,127780000000,39384000000,15570000,19984000000,28637000000,44487000000,15850000000,22787000000,757000000),
	 ('600519','2017-06-30',75623000000,120383000000,41304000000,15570000,11251000000,16124000000,25494000000,9370000000,6934999999.999999,480999999.99999994),
	 ('600519','2017-03-31',79018000000,118979000000,36509000000,15570000,6123000000,8790000000,13913000000,5123000000,6109000000,307000000),
	 ('600519','2016-12-31',72894000000,112934999999.99998,37020000000,15570000,16718000000,24266000000,40155000000,15888999999.999998,37451000000,1019000000),
	 ('600519','2016-09-30',68642999999.99999,105146000000,33847000000.000004,15570000,12466000000,18150000000,27533000000,9383000000,32535000000.000004,775000000),
	 ('600519','2016-06-30',64979000000,95546000000,28177999999.999996,15570000,8803000000,12760000000,18738000000,5977000000,13604000000,497000000),
	 ('600519','2016-03-31',68819000000,90690000000,19734000000,15570000,4889000000,7203000000,10251000000,3048000000,7436000000,367000000);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('600519','2015-12-31',63926000000,86301000000,20052000000,15570000,15503000000,22159000000,33447000000.000004,11292000000,17436000000,2061000000),
	 ('600519','2015-09-30',59848000000,77559000000,15622000000,17770000,11425000000,16294999999.999998,23734000000,7443000000.000001,11423000000,1811000000),
	 ('600519','2015-06-30',61304000000,72338000000,8658000000,17770000,7888000000,11152000000,16186000000.000002,5037000000,4902000000,1276000000),
	 ('600519','2015-03-31',57786000000,68769000000,8821000000,17770000,4365000000,6204000000,8760000000,2556000000,2112000000,866000000),
	 ('600519','2014-12-31',53429999999.99999,65873000000,10544000000,17770000,15350000000,22103000000,32217000000,10117000000,12633000000,4431000000),
	 ('600519','2014-09-30',48741000000,58652000000,8292000000,17770000,10693000000,15316000000,22173000000,6859999999.999999,7679000000.000001,3697999999.9999995),
	 ('600519','2014-06-30',45277000000,55217999999.99999,8576000000.000001,17770000,7230000000,10251000000,14616000000,4368000000,4289000000,2846000000),
	 ('600519','2014-03-31',46288000000,56029999999.99999,8558000000,17770000,3699000000,5320000000,7581999999.999999,2262000000,174000000,2025000000),
	 ('600519','2013-12-31',42622000000,55454000000,11307000000,17770000,15137000000,21792000000,31070999999.999996,9282000000,12655000000,5406000000),
	 ('600519','2013-09-30',38551000000,49274000000,9436000000,17770000,11070000000,16013000000,22002000000,5992000000,9245000000,3945000000.0000005);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('600519','2013-06-30',34734000000,43621000000,7823999999.999999,17770000,7248000000,10398000000,14137000000,3743000000,5215000000,2527000000),
	 ('600519','2013-03-31',37743000000,45902000000,7289000000,17770000,3593000000,5370000000,7166000000,1796000000,790000000,1125000000),
	 ('600519','2012-12-31',34150000000,44998000000,9526000000,17770000,13308000000.000002,18831000000,26455000000,7628000000,11921000000,4211999999.9999995),
	 ('600519','2012-09-30',31258999999.999996,38835000000,6826000000.000001,17770000,10420000000,14687000000,19931000000,5247000000,7562000000,3042000000),
	 ('600519','2012-06-30',27837000000,39711000000,11289000000,17770000,6995999999.999999,9800000000,13263999999.999998,3468000000,4460000000,1701000000.0000002),
	 ('600519','2012-03-31',27960000000.000004,36408000000,7859000000,17770000,2969000000,4172999999.9999995,6016000000,1843000000,1340000000,679000000),
	 ('600519','2011-12-31',24991000000,34901000000,9481000000,16770000,8763000000,12336000000,18402000000,6070000000,10149000000,2185000000),
	 ('600519','2011-09-30',22797000000,32894000000,9791000000,19530000,6569000000,9282000000,13641999999.999998,4363000000,9027000000,1234000000),
	 ('600519','2011-06-30',21135000000,30920000000,9356000000,19530000,4907000000,6890000000.000001,9826000000,2939000000,5328000000,747000000),
	 ('600519','2011-03-31',20283000000,29162000000,8611000000,10000000,1884000000,2652000000,4221000000,1568000000,3411000000,301000000);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('600519','2010-12-31',18399000000,25588000000,7028000000,10000000,5051000000,7161000000,11633000000,4473000000,6201000000,1732000000),
	 ('600519','2010-09-30',17522000000,22810000000,5078000000,10000000,4174000000,5898000000,9328000000,3429999999.9999995,3964000000,1394000000),
	 ('600519','2010-06-30',16447000000,21334000000,4587000000,10000000,3100000000,4381000000,6587000000,2207000000,1766000000,1080000000),
	 ('600519','2010-03-31',15732000000,20430000000,4424000000,10000000,1266000000,1796000000,3040000000,1244000000,825000000,469000000.00000006),
	 ('600519','2009-12-31',14466000000,19770000000,5108000000,10000000,4312000000,6076000000,9670000000,3596000000,4224000000,1357000000),
	 ('600519','2009-09-30',13940000000,16738000000,2512000000,10000000,3786999999.9999995,5306000000,7806999999.999999,2502000000,2078000000,1059000000),
	 ('600519','2009-06-30',12944000000,15974000000,2797000000,10000000,2790000000,3904999999.9999995,5546000000,1642000000.0000002,548000000,689000000),
	 ('600519','2009-03-31',12462000000,15626000000,3007000000,10000000,1217000000,1705000000,2513000000,808000000,-131000000,289000000),
	 ('600519','2008-12-31',11245000000,15754000000,4251000000,NULL,3799000000,5390000000,8242000000,2853000000,5247000000,1011000000),
	 ('600519','2008-09-30',10590000000,12988999999.999998,2182000000,NULL,3145000000,4411000000,6487000000,2076000000.0000002,3069000000,644000000);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('600519','2008-06-30',9685000000,11276000000,1421000000,NULL,2240000000,3144000000,4620000000,1476000000,1496000000,409999999.99999994),
	 ('600519','2008-03-31',9107000000,11557000000,2271000000,NULL,873000000,1222000000,1993000000,772000000,993000000,175000000),
	 ('600519','2007-12-31',8234000000,10481000000,2113000000,NULL,2831000000,4525000000,7237000000,2714000000,1743000000,772000000),
	 ('600519','2007-09-30',6875000000,10194000000,3240999999.9999995,NULL,1590000000,2506000000,4458000000,1954000000,1548000000,546000000),
	 ('600519','2007-06-30',6134000000,10227000000,4008000000,NULL,850000000,1359000000,2629000000,1271000000,686000000,333000000),
	 ('600519','2007-03-31',5821000000,9883000000,3995000000.0000005,NULL,536000000.00000006,873000000,1588000000,714000000,381000000,183000000),
	 ('600519','2006-12-31',6063000000,9571000000,3403000000,NULL,1545000000,2487000000,4903000000,2418000000,2113000000,737000000),
	 ('600519','2006-09-30',5344000000,8806000000,3390999999.9999995,NULL,1009000000,1688000000,3252000000.0000005,1564000000,1491000000,544000000),
	 ('600519','2006-06-30',5002000000,7800000000,2741000000,NULL,574000000,958000000,2013000000,1055000000.0000001,595000000,312000000),
	 ('600519','2006-03-31',5542000000,8103000000,2515000000,NULL,432000000,670000000,1353000000,683000000,225000000,105000000);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('600519','2005-12-31',5092000000,8058000000,2895000000,NULL,1119000000,1919000000.0000002,3931000000,2012000000,1694000000.0000002,541000000),
	 ('600519','2005-09-30',4713000000,7077000000,2312000000,NULL,702000000,1149000000,2580000000,1431000000,884000000,389000000),
	 ('600519','2005-06-30',4650000000,6729000000.000001,2037000000,NULL,480999999.99999994,756000000,1686000000,931000000,437000000,243000000.00000003),
	 ('600519','2005-03-31',4538000000,6572000000,1971000000,300000.0,369000000,557000000,1144000000,586000000,242000000,102000000),
	 ('600519','2004-12-31',4169000000,6374000000,2157000000,300000.0,821000000.0000001,1488000000,3010000000,1522000000,976000000,355000000),
	 ('600519','2004-09-30',3864000000,5629000000,1728000000,300000.0,516000000,876000000,2070000000,1195000000,373000000,227999999.99999997),
	 ('600519','2004-06-30',3788000000.0000005,5041000000,1224000000,300000.0,349000000,570000000,1314000000,744000000,-37984500,138000000),
	 ('600519','2004-03-31',3704000000,4855000000,1127000000,300000.0,262000000,401000000,852999999.9999999,451999999.99999994,-181000000,73503900),
	 ('600519','2003-12-31',3439000000,4956000000,1486000000,300000.0,587000000,975000000,2401000000,1427000000,942000000,335000000),
	 ('600519','2003-09-30',3207000000,4467000000,1235000000,NULL,354000000,595000000,1553000000,960000000,438999999.99999994,300000000);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('600519','2003-06-30',3105000000,3940999999.9999995,816000000,NULL,252999999.99999997,411000000.00000006,1009000000,600000000,-33965900,200999999.99999997),
	 ('600519','2003-03-31',3070000000,3904000000,802999999.9999999,NULL,218000000.00000003,341000000,734000000,394000000,9112200.0,107000000),
	 ('600519','2002-12-31',2852000000,3931000000,1056000000,NULL,376000000,648000000,1835000000.0000002,1190000000,434999999.99999994,467000000),
	 ('600519','2002-06-30',2769000000,3421000000,637000000,NULL,238000000,401999999.99999994,956000000,555000000,-180000000,261000000),
	 ('600519','2001-12-31',2531000000,3463000000.0000005,926000000,NULL,328000000,610000000,1618000000,1009000000,42283000,332000000),
	 ('600519','2001-06-30',562000000,1214000000,642000000,NULL,223000000,374000000,874000000,501000000,-86280900,NULL),
	 ('600519','2000-12-31',442000000,1269000000,825000000,NULL,250000000,446000000,1114000000,667000000,443000000,33824000),
	 ('000001','2024-09-30',490468999999.99994,5750000000000,5260000000000,NULL,39729000000,47869000000,111582000000,63713000000,137158000000,1121000000),
	 ('000001','2024-06-30',481868999999.99994,5750000000000,5270000000000,NULL,25879000000.000004,32087000000,77132000000,45045000000,113722000000,631000000),
	 ('000001','2024-03-31',485576000000,5730000000000,5240000000000,NULL,14932000000,18554000000,38770000000,20216000000,-21382000000,241000000);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('000001','2023-12-31',472328000000,5590000000000,5110000000000,NULL,46455000000,57928000000,164699000000,106771000000,92461000000,3096000000),
	 ('000001','2023-09-30',465860000000.00006,5520000000000,5050000000000,NULL,39635000000,49047000000,127633999999.99998,78587000000,115930000000,2173000000),
	 ('000001','2023-06-30',452072999999.99994,5500000000000,5050000000000,NULL,25387000000,31937000000,88610000000,56673000000,44241000000,949000000),
	 ('000001','2023-03-31',446745000000,5460000000000,5010000000000,NULL,14602000000.000002,18369000000,45098000000,26729000000.000004,109156000000,394000000),
	 ('000001','2022-12-31',434680000000,5320000000000,4890000000000,NULL,45516000000,57475000000,179895000000,122420000000,134572000000,3543000000),
	 ('000001','2022-09-30',425384000000,5200000000000,4770000000000,NULL,36659000000,46295000000,138265000000,91970000000,92518000000,2435000000),
	 ('000001','2022-06-30',412097999999.99994,5110000000000,4700000000000,NULL,22088000000,27961000000,92022000000,64061000000,150483000000,616000000),
	 ('000001','2022-03-31',406175000000,5120000000000,4710000000000,NULL,12850000000,16340000000,46207000000,29867000000,147127000000,204000000),
	 ('000001','2021-12-31',395448000000,4920000000000,4530000000000,NULL,36336000000,45985000000,169383000000,123398000000,-192733000000,6614000000),
	 ('000001','2021-09-30',388858000000,4850000000000,4460000000000,NULL,29135000000.000004,36829000000,127190000000.00002,90361000000,-125808000000,5933000000);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('000001','2021-06-30',377193000000,4720000000000,4349999999999.9995,NULL,17583000000,22415000000,84680000000,62265000000,-115972000000,4310000000),
	 ('000001','2021-03-31',372617000000,4570000000000,4200000000000,NULL,10132000000,12929000000,41788000000,28858999999.999996,-11553000000,3550000000),
	 ('000001','2020-12-31',364131000000,4470000000000,4099999999999.9995,NULL,28927999999.999996,36909000000,153542000000,116633000000,-16161000000.000002,3490000000),
	 ('000001','2020-09-30',358771000000,4349999999999.9995,3990000000000,NULL,22398000000,28923000000,116564000000.00002,87641000000,30698000000,1695000000),
	 ('000001','2020-06-30',351397000000,4179999999999.9995,3830000000000,NULL,13678000000,17659000000,78328000000,60669000000.00001,-25666000000.000004,782000000),
	 ('000001','2020-03-31',352355000000,4130000000000,3780000000000,NULL,8548000000,10998000000,37926000000,26927999999.999996,18006000000,551000000),
	 ('000001','2019-12-31',312983000000,3940000000000,3630000000000,NULL,28195000000,36289000000,137958000000,101669000000,-40025000000,3553000000),
	 ('000001','2019-09-30',288073000000,3710000000000,3420000000000,NULL,23621000000,30713000000,102958000000,72245000000,84480000000,1878000000),
	 ('000001','2019-06-30',256603000000.00003,3590000000000,3330000000000,NULL,15403000000,20037000000,67829000000,47792000000,26432000000,958000000),
	 ('000001','2019-03-31',250938000000,3530000000000,3280000000000,NULL,7445999999.999999,9667000000,32476000000,22809000000,53184000000,409000000);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('000001','2018-12-31',240042000000,3420000000000,3180000000000,NULL,24818000000,32305000000,116716000000.00002,84411000000,-57323000000,4619000000),
	 ('000001','2018-09-30',235231000000,3350000000000,3120000000000,NULL,20456000000,26614000000,86664000000,60050000000,-11310000000,1518000000),
	 ('000001','2018-06-30',228141000000,3370000000000,3140000000000,NULL,13372000000,17402000000,57241000000,39839000000,7455000000,682000000),
	 ('000001','2018-03-31',223391000000,3340000000000,3120000000000,NULL,6595000000,8584000000,28026000000,19442000000,41442000000,27000000),
	 ('000001','2017-12-31',222054000000,3250000000000,3030000000000,NULL,23189000000,30223000000,105785999999.99998,75563000000,-118780000000,2817000000),
	 ('000001','2017-09-30',218111000000,3140000000000,2920000000000,NULL,19153000000,24999000000,79832000000,54833000000.00001,-157987000000,857000000),
	 ('000001','2017-06-30',211454000000,3090000000000,2880000000000,NULL,12554000000,16463999999.999998,54069000000.00001,37605000000,-128180000000,413000000),
	 ('000001','2017-03-31',207739000000,3010000000000,2800000000000,NULL,6214000000,8242000000,27726000000,19484000000,-115008000000,125000000),
	 ('000001','2016-12-31',202171000000,2950000000000,2750000000000,NULL,22599000000,29779000000.000004,107715000000.00002,77936000000,10989000000,2772000000),
	 ('000001','2016-09-30',198228000000,2790000000000,2590000000000,NULL,18719000000,24545000000,81968000000,57423000000,-152942000000,906000000);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('000001','2016-06-30',191700000000,2800000000000,2610000000000,NULL,12292000000,16156000000,54769000000.00001,38613000000,-33198000000,600000000),
	 ('000001','2016-03-31',187569000000,2680000000000,2490000000000,NULL,6086000000,8014000000,27532000000,19518000000,59267999999.99999,236000000),
	 ('000001','2015-12-31',161500000000,2510000000000,2350000000000,NULL,21865000000,28895000000,96163000000,67267999999.99999,-1826000000.0000002,3534000000.0000005),
	 ('000001','2015-09-30',157136000000,2600000000000,2440000000000,NULL,17740000000,23305000000,71152000000,47847000000,91985000000,2444000000),
	 ('000001','2015-06-30',150880000000,2570000000000,2420000000000,NULL,11585000000,15266999999.999998,46575000000,31308000000,182522000000,1692000000.0000002),
	 ('000001','2015-03-31',136704000000,2300000000000,2170000000000,NULL,5629000000,7447000000,20671000000,13224000000,11495000000,1251000000),
	 ('000001','2014-12-31',130949000000,2190000000000,2060000000000,NULL,19802000000,26245999999.999996,73407000000,47161000000,25321000000,3835000000),
	 ('000001','2014-09-30',126735999999.99998,2140000000000.0002,2020000000000,NULL,15694000000,20771000000,54651000000,33880000000,-5109000000,2155000000),
	 ('000001','2014-06-30',120940000000.00002,2140000000000.0002,2020000000000,NULL,10072000000,13344999999.999998,34733000000,21388000000,53424000000,1447000000),
	 ('000001','2014-03-31',117300000000,2100000000000,1980000000000,NULL,5054000000,6712000000,16100000000,9388000000,60097000000,1231000000);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('000001','2013-12-31',112081000000,1890000000000,1780000000000,NULL,15231000000,19955000000,52189000000,32233999999.999996,91674000000,1750000000),
	 ('000001','2013-09-30',94913000000,1860000000000,1760000000000,NULL,11696000000,15307000000,37345000000,22038000000,100823000000,448000000.00000006),
	 ('000001','2013-06-30',91542000000,1830000000000,1740000000000,NULL,7531000000,9894000000,23426000000,13532000000,28800000000,231000000),
	 ('000001','2013-03-31',88759000000,1810000000000,1720000000000,NULL,3589000000,4717000000,10802000000,6085000000,14119000000,49000000),
	 ('000001','2012-12-31',84799000000,1610000000000,1520000000000,NULL,13403000000,17543000000,39749000000,22206000000,185838000000,1422000000),
	 ('000001','2012-09-30',81726000000,1480000000000,1400000000000,NULL,10237000000,13359000000,29531000000,16172000000,82783000000,328000000),
	 ('000001','2012-06-30',79823000000,1490000000000,1410000000000,NULL,6761000000,8837000000,19626000000,10789000000,144030000000,196000000),
	 ('000001','2012-03-31',76815000000,1370000000000,1290000000000,NULL,3429000000,4465000000,9724000000,5259000000,76828000000,45000000),
	 ('000001','2011-12-31',73311000000,1260000000000,1180000000000,NULL,10279000000,13133000000.000002,29643000000,16510000000,-14438999999.999998,850000000),
	 ('000001','2011-09-30',69708000000,1210000000000,1140000000000,NULL,7687000000,9819000000,20701000000,10883000000,17883000000,351000000);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('000001','2011-06-30',38152000000,852057000000,813905000000,NULL,4731000000,6047000000,12137000000,6090000000,31613000000,95378000),
	 ('000001','2011-03-31',35950000000,807563000000,771613000000,NULL,2402000000,3060000000,5815000000,2755000000,21347000000,30673000),
	 ('000001','2010-12-31',33513000000,727610000000,694097000000,NULL,6247000000,7800000000,17972000000,10172000000,22046000000,838000000.0000001),
	 ('000001','2010-09-30',32144000000,675064000000,642920000000,NULL,4718000000,5897000000,13137000000,7240000000.000001,10580000000,589000000),
	 ('000001','2010-06-30',30420999999.999996,624398000000,593977000000,NULL,3033000000,3804999999.9999995,8495999999.999999,4691000000,-3033000000,272000000),
	 ('000001','2010-03-31',22110000000,619928000000,597818000000,NULL,1578000000,1995000000,4084000000.0000005,2089000000,8610000000,104000000),
	 ('000001','2009-12-31',20470000000,587811000000,567341000000,NULL,5031000000,6159000000,15113999999.999998,8955000000,32194000000,985000000),
	 ('000001','2009-09-30',19088000000,554265000000,535176000000,NULL,3636999999.9999995,4526000000,11114000000,6588000000,-258000000,686000000),
	 ('000001','2009-06-30',17987000000,541226000000,523238000000,NULL,2311000000,2922000000,7491000000,4569000000,3845000000.0000005,252000000),
	 ('000001','2009-03-31',17072000000,521879000000,504807000000,NULL,1122000000,1514000000,3761000000,2247000000,2706000000,NULL);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('000001','2008-12-31',16401000000,474439999999.99994,458039000000.00006,NULL,614000000,802999999.9999999,14513000000,13710000000,24343000000,838000000.0000001),
	 ('000001','2008-09-30',18375000000,441454000000,423080000000,NULL,3317000000,4364000000,10741000000,6377000000,39546000000,478000000),
	 ('000001','2008-06-30',16943000000,441822999999.99994,424880000000,NULL,2144000000.0000002,2841000000,7115000000.000001,1847000000,9287000000,98633000),
	 ('000001','2008-03-31',14041000000,409474000000,395433000000,NULL,1003999999.9999999,1376000000,3553000000,2177000000,3826000000,48682000),
	 ('000001','2007-12-31',13006000000,352539000000,339533000000,NULL,2650000000,3722000000,10808000000,7086000000,17052000000.000002,372000000),
	 ('000001','2007-09-30',8364000000,340527000000,332163000000,NULL,1873999999.9999998,2776000000,7767000000,4991000000,20584000000,637000000),
	 ('000001','2007-06-30',7698000000,314056000000,306358000000,NULL,1124000000,1682000000,4891000000,3209000000.0000005,13171000000,97045000),
	 ('000001','2007-03-31',7106000000,287659000000,280553000000,NULL,534999999.99999994,819000000,2353000000,1534000000,3719000000,746000000),
	 ('000001','2006-12-31',6597000000,260761000000,254164000000,NULL,1412000000,2041000000,7818000000.000001,5777000000,11506000000,219000000),
	 ('000001','2006-09-30',6054000000,246230000000.00003,240176000000.00003,NULL,972000000.0000001,1481000000,5585000000,4104000000,6254000000,63568700);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('000001','2006-06-30',5592000000,242823999999.99997,237232000000.00003,NULL,518000000,778000000,3453000000,2675000000,1264000000,97694000),
	 ('000001','2006-03-31',5264000000,239558000000,234292999999.99997,NULL,233000000,331000000,1597000000,1266000000,13663000000,36255000),
	 ('000001','2005-12-31',5043000000,229216000000,224173000000,NULL,311000000,634000000,5451000000,4817000000,-4286000000,873000000),
	 ('000001','2005-09-30',5015000000,220516000000,215501000000.00003,NULL,300000000,534000000,4039000000,3504999999.9999995,-3963000000.0000005,99735400.00000001),
	 ('000001','2005-06-30',4892000000,210506000000,205613000000,NULL,168000000,330000000,2641000000,2311000000,-1361000000,62617900),
	 ('000001','2005-03-31',4839000000,201204000000,196365000000,NULL,154000000,1002999999.9999999,1976000000.0000002,NULL,-1911000000,189000000),
	 ('000001','2004-12-31',4685000000,204286000000,199602000000,NULL,295000000,2799000000,8345999999.999999,NULL,7045999999.999999,246000000),
	 ('000001','2004-09-30',4372000000,198848000000,194476000000,NULL,338000000,2477000000,6086000000,NULL,-4132000000,172000000),
	 ('000001','2004-06-30',4251000000,203194000000,198944000000,NULL,217000000,1745000000,4083000000,NULL,-2889000000,134000000.00000001),
	 ('000001','2004-03-31',4179000000,212496999999.99997,208319000000,NULL,158000000,860000000,1909000000,NULL,3103000000,168000000);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('000001','2003-12-31',3965000000,192851000000,188886000000,NULL,425000000,2327000000,5993000000,NULL,-1669000000.0000002,486000000.00000006),
	 ('000001','2003-09-30',3982000000,193396000000,189414000000,NULL,315000000,1684000000,4140999999.9999995,NULL,-7352000000,216000000),
	 ('000001','2003-06-30',4330000000,175455000000,171125000000,NULL,270000000,1202000000,2822000000,NULL,-3878000000,120000000),
	 ('000001','2003-03-31',3921000000,162467000000,158546000000,NULL,153000000,526999999.99999994,1353000000,NULL,-8915000000,105000000),
	 ('000001','2002-12-31',3768000000,166166000000,162398000000,NULL,313000000,2417000000,5400000000,NULL,8544000000,595000000),
	 ('000001','2002-06-30',3942000000,134689000000.00002,130747000000,NULL,314000000,1226000000,2413000000,NULL,-10375000000,265000000),
	 ('000001','2001-12-31',3628000000,120127000000,116499000000,NULL,401999999.99999994,1601000000.0000002,3886000000,NULL,14641999999.999998,700000000),
	 ('000001','2001-06-30',4962000000,85181000000,80220000000,NULL,223000000,687000000,1570000000,NULL,1230000000,604000000),
	 ('000001','2000-12-31',4739000000,67227000000,62489000000,NULL,463000000,867000000,2789000000,NULL,1591000000,577000000),
	 ('000001','2000-06-30',3079000000,49732000000,46654000000,NULL,140000000,310000000,1041000000,NULL,177000000,285000000);
INSERT INTO public.fundamental_data (stock_code,report_date,total_equity,total_assets,current_liabilities,noncurrent_liabilities,net_profit,operating_profit,total_revenue,total_cost,net_cash_from_operating,cash_for_fixed_assets) VALUES
	 ('000001','1999-12-31',1142000000,43912000000,42771000000,NULL,224000000.00000003,516000000,2203000000,NULL,4600000000,345000000),
	 ('000001','1999-06-30',3918000000,38712000000,34795000000,NULL,241000000,279000000,1135000000,NULL,-1491000000,115999999.99999999),
	 ('000001','1998-12-31',3677000000.0000005,39400000000,35723000000,NULL,714000000,808000000,2804000000,NULL,2445000000,319000000),
	 ('000001','1998-06-30',3772000000,34873000000,31095999999.999996,NULL,378000000,434999999.99999994,1294000000,NULL,1582000000,168000000);

            """
            db.execute(text(sql5))
            db.commit()
            sql6 = """
            INSERT INTO public.suspend_data (stock_code,suspend_date,resume_date,suspend_period,suspend_reason,market) VALUES
                ('600605','2022-09-19','2022-09-23','连续停牌','刊登重要公告','上交所主板'),
                ('000001','2014-07-15','2014-07-15','停牌一天','重要事项未公告','深交所主板'),
                ('600519','2012-12-10','2012-12-10','停牌一天','重要事项未公告','上交所主板');
            """
            db.execute(text(sql6))
            db.commit()
            from app.backtest.value_strategy import backtest_strategy
            backtest_strategy()
        except Exception as e:
            print(f"Error executing SQL: {e}")
        finally:
            db.rollback()
            stock_hist_adj_dao = StockHistAdjDao._instance
            stock_hist_adj_dao.delete_all()
            stock_info_dao = StockInfoDao._instance
            stock_info_dao.delete_all()
            fundamental_data_dao = FundamentalDataDao._instance
            fundamental_data_dao.delete_all()
            suspend_data_dao = SuspendDataDao._instance
            suspend_data_dao.delete_all()

def test_update_industry(app):
	stock_info_dao = StockInfoDao._instance
	stock_info_dao.update_all_industry()
    
def test_get_fund_prices_by_code_list(app):
    code_list = ['008115', '019919', '018733']
    df = get_fund_prices_by_code_list(code_list, '2024-03-01', '2025-01-05')
    print(df)
    
def test_get_fund_fees_by_code_list(app):
    code_list = ['008115', '019919', '018733']
    fees_dict = get_fund_fees_by_code_list(code_list)
    print(fees_dict)